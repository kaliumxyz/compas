<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Release notes v0.0.119 | Compas</title>
    <meta name="description" content="Unified backend tooling">
    <link rel="stylesheet" href="/assets/style.d82f6ee1.css">
    <link rel="modulepreload" href="/assets/Home.91b8674b.js">
    <link rel="modulepreload" href="/assets/app.d0d65fcc.js">
    <link rel="modulepreload" href="/assets/releases_0.0.119.md.94b4c999.lean.js">
    <link rel="modulepreload" href="/assets/app.d0d65fcc.js">
    <meta name="twitter:title" content="Release notes v0.0.119 | Compas">
    <meta property="og:title" content="Release notes v0.0.119 | Compas">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="Compas, back to home" data-v-675d8756 data-v-4a583abe><!----> Compas</a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Docs <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/api/index.html" data-v-b8818f8c>API reference <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog" data-v-b8818f8c>Changelog <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/releases/index.html" data-v-b8818f8c>Release notes <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/compasjs/compas" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Docs <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/api/index.html" data-v-b8818f8c>API reference <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/changelog" data-v-b8818f8c>Changelog <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item active" href="/releases/index.html" data-v-b8818f8c>Release notes <!----></a></div></div><!--]--><!----><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item isExternal" href="https://github.com/compasjs/compas" target="_blank" rel="noopener noreferrer" data-v-b8818f8c>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-b8818f8c><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.158.html">Release v0.0.158</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.138.html">Release v0.0.138</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.124.html">Release v0.0.124</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/releases/0.0.119.html">Release v0.0.119</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#code-gen">Code gen</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#store">Store</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#in-closing">In closing</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.115.html">Release v0.0.115</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.103.html">Release v0.0.103</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.89.html">Release v0.0.89</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.84.html">Release v0.0.84</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.83.html">Release v0.0.83</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.81.html">Release v0.0.81</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/releases/0.0.79.html">Release v0.0.79</a><!----></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="release-notes-v0-0-119" tabindex="-1">Release notes v0.0.119 <a class="header-anchor" href="#release-notes-v0-0-119" aria-hidden="true">#</a></h1><p>More breaking changes, results in more release notes. So to do my self a favor, I should stop doing breaking changes, so I don&#39;t have to write release notes. Does it work that way? Maybe.</p><h2 id="code-gen" tabindex="-1">Code gen <a class="header-anchor" href="#code-gen" aria-hidden="true">#</a></h2><p>We are well on our way to enable the JSDoc eslint plugin. At last, the generator output should now be stable and never trigger an error when the jsdoc rules are enabled.</p><p>There was a bug in the generated sql &#39;where xxxIn&#39; behaviour. The generated where function would ignore an empty array, that could result in unexpectedly updating or deleting all rows of a table. In this release, an empty &#39;where xxxIn&#39; array should result in zero rows updated, deleted or selected.</p><p>We now have dynamic <code>ORDER BY</code> support in the sql generator. This works by accepting an array of columns you want to sort on, and an optional order specification. Using it would look something like the following:</p><div class="language-js"><pre><code><span class="token comment">// Get users sorted by their age, ascending</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> query<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">SELECT * FROM &quot;user&quot; u </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">userOrderBy</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>
  sql<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get users sorted by their age descending, and if multiple users have the same age, on name ascending.</span>
<span class="token comment">// In tis case name is an optional column, so we can specify where the &#39;null&#39; values should go.</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> query<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">SELECT * FROM &quot;user&quot; u </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">userOrderBy</span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    age<span class="token operator">:</span> <span class="token string">&quot;DESC&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">&quot;ASC NULLS FIRST&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The values that can be put in the &#39;orderBy&#39; and &#39;orderBySpec&#39; arguments, should be marked as <code>.searchable()</code> in the spec. Of course the query builder also supports these fields:</p><div class="language-js"><pre><code><span class="token keyword">const</span> <span class="token punctuation">[</span>newestUser<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">queryUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;createdAt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  orderBySpec<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;DESC&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  posts<span class="token operator">:</span> <span class="token punctuation">{</span>
    limit<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;likedCount&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  limit<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The above would get the &#39;newest&#39; user, with a single post that has the least likes. The default behaviour is still the same, <code>orderBy: [&quot;createdAt&quot;, &quot;updatedAt&quot;, &quot;id&quot;]</code>. However, you need to update the <code>xxxOrderBy</code> calls where you specified for example the <code>tableName</code> argument.</p><h2 id="store" tabindex="-1">Store <a class="header-anchor" href="#store" aria-hidden="true">#</a></h2><p>We removed the <code>getNestedFileGroup</code> in this release as the query builder has the same options and more. The only limit is that the new call doesn&#39;t return the full group depth, but instead you always specify the levels you need.</p><p>The following examples illustrate equal behaviour:</p><div class="language-js"><pre><code><span class="token comment">// Old</span>
<span class="token keyword">await</span> <span class="token function">getNestedFileGroup</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">{</span> excludeFiles<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// New, get 2 levels of children for all roots, correctly ordered.</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">queryFileGroup</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">{</span>
    orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">{</span>
      orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  where<span class="token operator">:</span> <span class="token punctuation">{</span>
    parentIsNull<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js"><pre><code><span class="token comment">// Old</span>
<span class="token keyword">await</span> <span class="token function">getNestedFileGroup</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">{</span> rootId<span class="token operator">:</span> myFileGroupId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// New, get 1 level of children for the specified &#39;root&#39;</span>
<span class="token comment">// and include the file, correctly ordered.</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">queryFileGroup</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">{</span>
    orderBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    file<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  where<span class="token operator">:</span> <span class="token punctuation">{</span>
    id<span class="token operator">:</span> myFileGroupId<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="in-closing" tabindex="-1">In closing <a class="header-anchor" href="#in-closing" aria-hidden="true">#</a></h2><p>That&#39;s it, we are expecting some more breaking changes in the query builder soon, as we move the <code>viaXxx</code> to the where builder instead. Also if you want to help design the next few things, pleas take a look at <a href="https://github.com/compasjs/compas/issues/690" target="_blank" rel="noopener noreferrer">dependencies between routes</a>, <a href="https://github.com/compasjs/compas/issues/568" target="_blank" rel="noopener noreferrer">consistent &amp; validated JSDoc</a> or <a href="https://github.com/compasjs/compas/issues/574" target="_blank" rel="noopener noreferrer">integrating OpenAPI 3 a bit more</a>.</p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><a class="link" href="https://github.com/compasjs/compas/edit/main/docs/releases/0.0.119.md" target="_blank" rel="noopener noreferrer" data-v-1ed99556>Edit this page on GitHub <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-1ed99556><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-fb8d84c6><p class="last-updated" data-v-fb8d84c6 data-v-5797b537><span class="prefix" data-v-5797b537>Last updated:</span><span class="datetime" data-v-5797b537></span></p></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/releases/0.0.124" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Release v0.0.124</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/releases/0.0.115" data-v-38ede35f><span class="text" data-v-38ede35f>Release v0.0.115</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"api_cli.md\":\"4cdee5be\",\"api_index.md\":\"b616f6f7\",\"api_server.md\":\"ca53b609\",\"api_stdlib.md\":\"ac25692b\",\"api_store.md\":\"fde2dff1\",\"changelog.md\":\"04a687e3\",\"contributing.md\":\"5a423064\",\"features_background-jobs.md\":\"df72ea91\",\"features_code-gen-api-client.md\":\"852f438e\",\"features_code-gen-api.md\":\"32d48024\",\"features_code-gen-validators.md\":\"73965e4e\",\"features_http-server.md\":\"5ae90427\",\"features_lint-setup.md\":\"2a41a0d8\",\"features_logger-and-events.md\":\"e9bb9a2f\",\"features_migrations.md\":\"430beccb\",\"features_postgres-and-minio.md\":\"a83146c9\",\"features_script-runner.md\":\"c24efe5c\",\"features_session-handling.md\":\"2bd6d4d8\",\"features_test-and-bench-runner.md\":\"43c389fd\",\"features_typescript-setup.md\":\"e171d93a\",\"getting-started.md\":\"3b37bea7\",\"index.md\":\"7ea19361\",\"migrations_index.md\":\"6590fc91\",\"migrations_store.md\":\"048e3b5c\",\"releases_0.0.103.md\":\"da6ff15e\",\"releases_0.0.115.md\":\"fd875c62\",\"releases_0.0.119.md\":\"94b4c999\",\"releases_0.0.124.md\":\"8898f7a1\",\"releases_0.0.138.md\":\"cf0701c4\",\"releases_0.0.158.md\":\"1ee03062\",\"releases_0.0.79.md\":\"1db2024d\",\"releases_0.0.81.md\":\"dd7dc405\",\"releases_0.0.83.md\":\"20746784\",\"releases_0.0.84.md\":\"bb83711b\",\"releases_0.0.89.md\":\"7abc11e4\",\"releases_index.md\":\"93b24ebb\",\"todo.md\":\"b1cb77d2\"}")</script>
    <script type="module" async src="/assets/app.d0d65fcc.js"></script>
    
  </body>
</html>